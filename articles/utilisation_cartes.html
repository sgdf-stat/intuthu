<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Réaliser des cartes sur les zonages SGDF • intuthu</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Réaliser des cartes sur les zonages SGDF">
<meta property="og:description" content="intuthu">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">intuthu</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/utilisation_cartes.html">Réaliser des cartes sur les zonages SGDF</a>
    </li>
    <li>
      <a href="../articles/utilisation_graphiques.html">Éléments graphiques</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/sgdf-stat/intuthu/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="utilisation_cartes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Réaliser des cartes sur les zonages SGDF</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sgdf-stat/intuthu/blob/master/vignettes/utilisation_cartes.Rmd"><code>vignettes/utilisation_cartes.Rmd</code></a></small>
      <div class="hidden name"><code>utilisation_cartes.Rmd</code></div>

    </div>

    
    
<div id="les-zonages-sgdf" class="section level2">
<h2 class="hasAnchor">
<a href="#les-zonages-sgdf" class="anchor"></a>Les zonages SGDF</h2>
<p>La géographie des Scouts et Guides de France ne correspond pas toujours aux zonages administratifs français. Deux zonages géographiques imbriquées existent :</p>
<ul>
<li>le territoire, auxquel se rattache les différents groupes locaux, en moyenne de la taille d’un département, mais souvent moins dans les départements où le scoutisme est très présent ou à cheval sur plusieurs départements dans les zones très ruales ;</li>
<li>le centre de ressource, qui regroupe plusieurs territoires.</li>
</ul>
<p>Les groupes locaux n’ont pas de zonage spécifique mais peuvent être placés sur une carte.</p>
</div>
<div id="représenter-des-données-sur-une-carte" class="section level2">
<h2 class="hasAnchor">
<a href="#repr%C3%A9senter-des-donn%C3%A9es-sur-une-carte" class="anchor"></a>Représenter des données sur une carte</h2>
<p>Les zonages spécifiques sont directement intégrés dans <code>intuthu</code>. Pour les zones administratives françaises, on peut par exemple utiliser <code>CARTElette</code> (<a href="https://github.com/antuki/CARTElette" class="uri">https://github.com/antuki/CARTElette</a>).</p>
<p>On utilisera principalement ici le package <code>sf</code> pour la manipulation de données spatiales et les éléments du <code>tidyverse</code> pour la manipulation et la représentation de données. Un cours introductif est disponible (<a href="https://tvroylandt.github.io/r-cartostat/" class="uri">https://tvroylandt.github.io/r-cartostat/</a>) et comporte d’autres ressources si besoin.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">intuthu</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)</pre></body></html></div>
<div id="chargement-et-ajout-de-données-externes" class="section level3">
<h3 class="hasAnchor">
<a href="#chargement-et-ajout-de-donn%C3%A9es-externes" class="anchor"></a>Chargement et ajout de données externes</h3>
<p>On commence par charger le fond de carte avec la fonction <code><a href="../reference/load_shp_sgdf.html">load_shp_sgdf()</a></code>. On doit lui préciser le niveau souhaité (territoire ou CR). On peut aussi éventuellement ajouter un filtre pour ne pas inclure le zoom sur l’Île-de-France ou les DOMs-TOMs.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">shp_terr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/load_shp_sgdf.html">load_shp_sgdf</a></span>(<span class="kw">niveau</span> <span class="kw">=</span> <span class="st">"terr"</span>)
<span class="no">shp_cr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/load_shp_sgdf.html">load_shp_sgdf</a></span>(<span class="kw">niveau</span> <span class="kw">=</span> <span class="st">"cr"</span>)</pre></body></html></div>
<p>On charge ensuite des données externes, par exemple un nombre d’adhérents, arrondi, par territoire. On jointe sur le fond de carte (celui-ci est toujours l’élément sur lequel on vient rajouter les données, pour des raisons de format de fichier).</p>
<p>On peut ensuite réaliser des opérations de discrétisation ou de calcul de part par exemple.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">df_adherents</span> <span class="kw">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"data_adherents_terr.rds"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"intuthu"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ungroup</span>()

<span class="no">shp_terr_adherents</span> <span class="kw">&lt;-</span> <span class="no">shp_terr</span> <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">code_terr_court</span> <span class="kw">=</span> <span class="fu">str_sub</span>(<span class="no">terr</span>, <span class="fl">1</span>, <span class="fl">5</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">left_join</span>(<span class="no">df_adherents</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"code_terr_court"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">mutate</span>(<span class="kw">part_adherents</span> <span class="kw">=</span> <span class="no">nb_adherents_arrondi</span> / <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">nb_adherents_arrondi</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>) * <span class="fl">100</span>)</pre></body></html></div>
</div>
<div id="carte-par-aplat-de-couleurs" class="section level3">
<h3 class="hasAnchor">
<a href="#carte-par-aplat-de-couleurs" class="anchor"></a>Carte par aplat de couleurs</h3>
<blockquote>
<p>Les parties graphiques (thèmes, couleurs, export) qui suivent sont davantage explicités dans la vignette sur la création de graphiques.</p>
</blockquote>
<p>Une carte par aplat de couleurs sert à représenter le plus souvent une proportion ou une valeur qualitative. Le défaut principal de ce type de carte est que des grandes surfaces qui ne représentent que peu d’individus faussent l’impression visuelle. Elles sont toutefois simples à interpréter.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">shp_terr_adherents</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>() +
  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="no">part_adherents</span>)) +
  <span class="fu"><a href="../reference/scale_fill_sgdf_continuous.html">scale_fill_sgdf_continuous</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>,
                             <span class="kw">reverse</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Part des adhérents (en %)"</span>) +
  <span class="fu"><a href="../reference/theme_sgdf_carte.html">theme_sgdf_carte</a></span>()</pre></body></html></div>
<p><img src="utilisation_cartes_files/figure-html/carte_aplat-1.png" width="576"></p>
<p>On peut ajouter en surimpression les contours des centres de ressources et leurs codes.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">shp_terr_adherents</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>() +
  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="no">cr</span>)) +
  <span class="fu">geom_sf</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">shp_cr</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1.1</span>) +
  <span class="fu">geom_sf_text</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">shp_cr</span>, <span class="fu">aes</span>(<span class="kw">label</span> <span class="kw">=</span> <span class="no">cr</span>), <span class="kw">family</span> <span class="kw">=</span> <span class="st">"Sarabun"</span>) +
  <span class="fu"><a href="../reference/scale_fill_sgdf_discrete.html">scale_fill_sgdf_discrete</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Centres de ressources"</span>) +
  <span class="fu"><a href="../reference/theme_sgdf_carte.html">theme_sgdf_carte</a></span>()</pre></body></html></div>
<p><img src="utilisation_cartes_files/figure-html/carte_aplat_contour_cr-1.png" width="576"></p>
</div>
<div id="carte-avec-cercles-proportionnels" class="section level3">
<h3 class="hasAnchor">
<a href="#carte-avec-cercles-proportionnels" class="anchor"></a>Carte avec cercles proportionnels</h3>
<p>Une carte par cercles proportionnels sert souvent à représenter un volume. Le défaut principal de ce type de carte est le recouvrement des cercles qui conduit à manquer parfois de visibilité, notamment sur des zones denses (Île-de-France par exemple).</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">shp_terr_adherents</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">nb_adherents_arrondi</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>() +
  <span class="fu">geom_sf</span>() +
  <span class="fu">geom_sf</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">shp_cr</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1.1</span>) +
  <span class="fu">stat_sf_coordinates</span>(<span class="fu">aes</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="no">nb_adherents_arrondi</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">nb_adherents_arrondi</span>),
                      <span class="kw">shape</span> <span class="kw">=</span> <span class="fl">21</span>) +
  <span class="fu"><a href="../reference/scale_fill_sgdf_continuous.html">scale_fill_sgdf_continuous</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>,
                             <span class="kw">palette</span> <span class="kw">=</span> <span class="st">"pal_sgdf_vert_compa"</span>,
                             <span class="kw">reverse</span> <span class="kw">=</span> <span class="fl">TRUE</span>) +
  <span class="fu">scale_size_continuous</span>(<span class="kw">name</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">range</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">10</span>)) +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Nombre d'adhérents"</span>) +
  <span class="fu"><a href="../reference/theme_sgdf_carte.html">theme_sgdf_carte</a></span>()</pre></body></html></div>
<p><img src="utilisation_cartes_files/figure-html/carte_cercles-1.png" width="576"></p>
</div>
</div>
<div id="localisation-des-groupes" class="section level2">
<h2 class="hasAnchor">
<a href="#localisation-des-groupes" class="anchor"></a>Localisation des groupes</h2>
<p>La localisation des groupes est disponible sous forme de points. Il n’y a pas de recodage. La localisation est donc la même que dans les autres outils de cartographie.</p>
<p>Par conséquent, il faut filtrer en amont sur le fond de carte territoire si on veut afficher quelque chose de propre.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">shp_groupes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/load_shp_sgdf.html">load_shp_sgdf</a></span>(<span class="st">"groupes"</span>)

<span class="no">shp_terr</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">type_geo</span> <span class="kw">==</span> <span class="st">"fr_metro"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>() +
  <span class="fu">geom_sf</span>() +
  <span class="fu">geom_sf</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">shp_groupes</span> <span class="kw">%&gt;%</span>
            <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">type_geo</span> <span class="kw">==</span> <span class="st">"fr_metro"</span>), <span class="fu">aes</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="no">cr</span>)) +
  <span class="fu"><a href="../reference/scale_color_sgdf_discrete.html">scale_color_sgdf_discrete</a></span>() +
  <span class="fu">labs</span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Groupes par CR"</span>) +
  <span class="fu">guides</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu"><a href="../reference/theme_sgdf_carte.html">theme_sgdf_carte</a></span>()</pre></body></html></div>
<p><img src="utilisation_cartes_files/figure-html/carte_groupes-1.png" width="576"></p>
<p>On peut aussi utiliser le fond de carte <code>shp_sgdf_terr_init</code> pour des cartes sur d’autres zonages que la France métropolitaine.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thomas Vroylandt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
